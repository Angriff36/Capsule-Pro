{"version":3,"sources":["../src/index.ts","../src/agent.ts","../src/errors.ts","../src/events.ts","../src/metrics.ts","../src/models.ts","../src/keys.ts","../src/retry.ts","../src/tool.ts","../src/types.ts","../src/workflow.ts"],"sourcesContent":["import { z } from \"zod\";\nimport type { ExecutionResult } from \"./agent.js\";\nimport { Agent, createAgent } from \"./agent.js\";\nimport {\n  AgentExecutionError,\n  AgentNotFoundError,\n  AuthenticationError,\n  CancellationError,\n  createSDKError,\n  ERROR_CODES,\n  RateLimitExceededError,\n  SDKError,\n  TimeoutError,\n  ToolExecutionError,\n} from \"./errors.js\";\nimport type {\n  AgentEvent,\n  LifecycleEvent,\n  ProgressEvent,\n  ToolEvent,\n} from \"./events.js\";\nimport { AgentEventEmitter } from \"./events.js\";\nimport type { AggregateMetrics } from \"./metrics.js\";\nimport { MetricsCollector } from \"./metrics.js\";\nimport { RetryManager } from \"./retry.js\";\nimport { createTool, Tool, ToolRegistry } from \"./tool.js\";\nimport type {\n  AgentConfig,\n  ExecutionOptions,\n  Metrics,\n  RetryConfig,\n  SDKConfig,\n  ToolConfig,\n} from \"./types.js\";\nimport { AgentWorkflow, createWorkflow } from \"./workflow.js\";\n\nexport type SDKOptions = {\n  apiKey?: string;\n  baseUrl?: string;\n  defaultTimeout?: number;\n  defaultMaxRetries?: number;\n  debug?: boolean;\n  metricsCollector?: MetricsCollector;\n};\n\nclass AISDK {\n  private readonly config: Required<SDKOptions>;\n  private readonly metricsCollector: MetricsCollector;\n  private initialized = false;\n  private credentialValidator?: () => Promise<boolean>;\n\n  constructor(options: SDKOptions = {}) {\n    this.config = {\n      apiKey: options.apiKey ?? process.env.API_KEY ?? \"\",\n      baseUrl: options.baseUrl ?? \"https://api.example.com\",\n      defaultTimeout: options.defaultTimeout ?? 60_000,\n      defaultMaxRetries: options.defaultMaxRetries ?? 3,\n      debug: options.debug ?? false,\n      metricsCollector: options.metricsCollector ?? new MetricsCollector(),\n    };\n    this.metricsCollector = this.config.metricsCollector;\n\n    if (this.config.debug) {\n      console.log(\"[AISDK] SDK initialized\");\n    }\n  }\n\n  async initialize(): Promise<void> {\n    if (this.initialized) {\n      return;\n    }\n\n    if (this.config.debug) {\n      console.log(\"[AISDK] Initializing...\");\n    }\n\n    if (this.credentialValidator) {\n      const isValid = await this.credentialValidator();\n      if (!isValid) {\n        throw new AuthenticationError(\"Invalid API key provided\", {\n          troubleshootingUrl:\n            \"https://docs.example.com/getting-started#api-key\",\n        });\n      }\n    }\n\n    this.initialized = true;\n\n    if (this.config.debug) {\n      console.log(\"[AISDK] Initialization complete\");\n    }\n  }\n\n  createAgent(\n    config: AgentConfig,\n    options?: {\n      executionHandler?: import(\"./agent.js\").ExecutionHandler;\n      metricsCollector?: MetricsCollector;\n    }\n  ): Agent {\n    const agent = createAgent(\n      {\n        ...config,\n        timeout: config.timeout ?? this.config.defaultTimeout,\n        maxRetries: config.maxRetries ?? this.config.defaultMaxRetries,\n      },\n      options as Parameters<typeof createAgent>[1]\n    );\n\n    return agent;\n  }\n\n  createTool<TParams extends Record<string, unknown>, TReturn>(\n    func: (\n      params: TParams,\n      context?: import(\"./tool.js\").ToolContext\n    ) => Promise<import(\"./tool.js\").ToolResult<TReturn>>,\n    options: ToolConfig\n  ): Tool<TParams, TReturn> {\n    const tool = new Tool(func, {\n      name: options.name,\n      description: options.description,\n      parameters: (options.parameters ?? {}) as Record<\n        string,\n        import(\"zod\").ZodType\n      >,\n      returns: (options.returns ?? z.unknown()) as import(\"zod\").ZodType,\n      retryable: options.retryable,\n    });\n    return tool;\n  }\n\n  createWorkflow(config: {\n    name: string;\n    steps: import(\"./workflow.js\").WorkflowStep[];\n    parallelExecution?: boolean;\n    timeout?: number;\n  }): AgentWorkflow {\n    return createWorkflow(config);\n  }\n\n  getMetrics(agentId?: string): Metrics[] {\n    if (agentId) {\n      return this.metricsCollector.getByAgentId(agentId);\n    }\n    return this.metricsCollector.getAll();\n  }\n\n  getAggregateMetrics(agentId: string): AggregateMetrics {\n    return this.metricsCollector.getAggregateByAgentId(agentId);\n  }\n\n  setCredentialValidator(validator: () => Promise<boolean>): void {\n    this.credentialValidator = validator;\n  }\n\n  async validateCredentials(): Promise<boolean> {\n    if (this.credentialValidator) {\n      return this.credentialValidator();\n    }\n    return true;\n  }\n\n  getMetricsCollector(): MetricsCollector {\n    return this.metricsCollector;\n  }\n\n  getConfig(): Readonly<Required<SDKOptions>> {\n    return Object.freeze({ ...this.config });\n  }\n\n  updateConfig(updates: Partial<SDKOptions>): void {\n    Object.assign(this.config, updates);\n  }\n}\n\nlet sdkInstance: AISDK | null = null;\n\nexport function initializeSDK(options?: SDKOptions): AISDK {\n  if (!sdkInstance) {\n    sdkInstance = new AISDK(options);\n  }\n  return sdkInstance;\n}\n\nexport function getSDK(): AISDK {\n  if (!sdkInstance) {\n    throw createSDKError(\"SDK not initialized. Call initializeSDK() first.\", {\n      code: ERROR_CODES.CONFIG_INVALID,\n      retryable: false,\n      troubleshootingUrl:\n        \"https://docs.example.com/getting-started#initialization\",\n    });\n  }\n  return sdkInstance;\n}\n\nexport {\n  AISDK,\n  createAgent,\n  createTool,\n  createWorkflow,\n  Agent,\n  Tool,\n  ToolRegistry,\n  AgentWorkflow,\n  AgentEventEmitter,\n  type AgentEvent,\n  type LifecycleEvent,\n  type ProgressEvent,\n  type ToolEvent,\n  SDKError,\n  createSDKError,\n  MetricsCollector,\n  RetryManager,\n  ERROR_CODES,\n  AuthenticationError,\n  RateLimitExceededError,\n  TimeoutError,\n  ToolExecutionError,\n  AgentNotFoundError,\n  AgentExecutionError,\n  CancellationError,\n};\n\nexport type {\n  ExecutionResult,\n  AgentConfig,\n  ExecutionOptions,\n  SDKConfig,\n  Metrics,\n  RetryConfig,\n  ToolConfig,\n  AggregateMetrics,\n};\n","import { Readable } from \"node:stream\";\nimport { generateText } from \"ai\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport {\n  CancellationError,\n  createSDKError,\n  ERROR_CODES,\n  SDKError,\n} from \"./errors.js\";\nimport {\n  type AgentEvent,\n  AgentEventEmitter,\n  type GenericListener,\n  type LifecycleEvent,\n} from \"./events.js\";\nimport { MetricsCollector } from \"./metrics.js\";\nimport { models } from \"./models.js\";\nimport { RetryManager } from \"./retry.js\";\nimport { type Tool, ToolRegistry } from \"./tool.js\";\nimport {\n  type AgentConfig,\n  AgentConfigSchema,\n  type ExecutionOptions,\n  ExecutionOptionsSchema,\n  type Metrics,\n} from \"./types.js\";\n\nexport type ExecutionResult = {\n  agentId: string;\n  executionId: string;\n  response: string;\n  metrics: Metrics;\n  streamed?: boolean;\n};\n\nexport interface StreamingResult extends ExecutionResult {\n  stream: Readable;\n}\n\nexport type ExecutionHandler = (\n  prompt: string,\n  context: {\n    agentId: string;\n    executionId: string;\n    tools: ToolRegistry;\n    abortSignal: AbortSignal;\n    onProgress: (data: AgentEvent) => void;\n  }\n) => Promise<string> | Readable;\n\nexport class Agent {\n  public readonly id: string;\n  public readonly name: string;\n  public readonly instructions: string;\n  public readonly toolNames: string[];\n  public readonly maxRetries: number;\n  public readonly timeout: number;\n  public readonly streaming: boolean;\n  public readonly debug: boolean;\n  private readonly eventEmitter: AgentEventEmitter;\n  private readonly toolRegistry: ToolRegistry;\n  private readonly metricsCollector: MetricsCollector;\n  private state: Record<string, unknown> = {};\n  private executionHandler: ExecutionHandler;\n  private abortController?: AbortController;\n  private isExecuting = false;\n\n  constructor(\n    config: AgentConfig,\n    options: {\n      executionHandler?: ExecutionHandler;\n      metricsCollector?: MetricsCollector;\n    } = {}\n  ) {\n    const parsed = AgentConfigSchema.parse(config);\n\n    this.id = uuidv4();\n    this.name = parsed.name;\n    this.instructions = parsed.instructions;\n    this.toolNames = parsed.tools ?? [];\n    this.maxRetries = parsed.maxRetries ?? 3;\n    this.timeout = parsed.timeout ?? 60_000;\n    this.streaming = parsed.streaming ?? false;\n    this.debug = parsed.debug ?? false;\n\n    this.eventEmitter = new AgentEventEmitter();\n    this.toolRegistry = new ToolRegistry();\n    this.metricsCollector = options.metricsCollector ?? new MetricsCollector();\n\n    this.executionHandler =\n      options.executionHandler ?? this.defaultExecutionHandler.bind(this);\n\n    if (this.debug) {\n      console.log(`[Agent] Created agent: ${this.name} (${this.id})`);\n    }\n  }\n\n  registerTool(tool: Tool): this {\n    this.toolRegistry.register(tool);\n    this.toolNames.push(tool.name);\n\n    if (this.debug) {\n      console.log(\n        `[Agent] Registered tool: ${tool.name} for agent ${this.name}`\n      );\n    }\n\n    return this;\n  }\n\n  setExecutionHandler(handler: ExecutionHandler): this {\n    this.executionHandler = handler;\n    return this;\n  }\n\n  async execute(options: ExecutionOptions): Promise<ExecutionResult> {\n    if (this.isExecuting) {\n      throw createSDKError(\"Agent is already executing\", {\n        code: ERROR_CODES.AGENT_EXECUTION_FAILED,\n        agentId: this.id,\n        retryable: false,\n      });\n    }\n\n    const parsed = ExecutionOptionsSchema.parse(options);\n    const executionId = uuidv4();\n    const startTime = Date.now();\n\n    this.isExecuting = true;\n    this.abortController = new AbortController();\n\n    if (parsed.signal) {\n      parsed.signal.addEventListener(\"abort\", () => {\n        this.abortController?.abort();\n      });\n    }\n\n    try {\n      this.emitStarted(executionId);\n\n      const retryManager = new RetryManager({\n        maxAttempts: this.maxRetries,\n        onRetry: (_attempt, error) => {\n          this.eventEmitter.emit(\"toolError\", {\n            type: \"toolError\",\n            toolName: \"agent\",\n            toolCallId: executionId,\n            error,\n          });\n        },\n      });\n\n      const retryResult = await retryManager.execute(async () => {\n        const response = await this.executionHandler(parsed.prompt, {\n          agentId: this.id,\n          executionId,\n          tools: this.toolRegistry,\n          abortSignal: this.abortController?.signal ?? new AbortSignal(),\n          onProgress: (event) => this.eventEmitter.emit(event.type, event),\n        });\n\n        return response;\n      }, this.abortController?.signal);\n\n      const responseStr = typeof retryResult === \"string\" ? retryResult : \"\";\n\n      const duration = Date.now() - startTime;\n      const metrics: Metrics = {\n        agentId: this.id,\n        duration,\n        tokens: {\n          input: this.estimateTokenCount(parsed.prompt),\n          output: this.estimateTokenCount(responseStr),\n          total:\n            this.estimateTokenCount(parsed.prompt) +\n            this.estimateTokenCount(responseStr),\n        },\n        toolCalls: 0,\n        retries: retryManager instanceof RetryManager ? this.maxRetries : 0,\n        errors: 0,\n        status: \"success\",\n        timestamp: new Date(),\n      };\n\n      this.metricsCollector.record(metrics);\n\n      this.emitCompleted(executionId, responseStr);\n\n      if (this.debug) {\n        console.log(\n          `[Agent] Execution completed: ${executionId} in ${duration}ms`\n        );\n      }\n\n      return {\n        agentId: this.id,\n        executionId,\n        response: responseStr,\n        metrics,\n      };\n    } catch (error) {\n      const duration = Date.now() - startTime;\n      const sdkError =\n        error instanceof SDKError\n          ? error\n          : createSDKError(String(error), {\n              code: ERROR_CODES.AGENT_EXECUTION_FAILED,\n              agentId: this.id,\n              retryable: true,\n            });\n\n      const metrics: Metrics = {\n        agentId: this.id,\n        duration,\n        tokens: {\n          input: this.estimateTokenCount(parsed.prompt),\n          output: 0,\n          total: this.estimateTokenCount(parsed.prompt),\n        },\n        toolCalls: 0,\n        retries: 0,\n        errors: 1,\n        status: \"error\",\n        timestamp: new Date(),\n      };\n\n      this.metricsCollector.record(metrics);\n\n      this.emitError(executionId, sdkError);\n\n      if (this.debug) {\n        console.log(`[Agent] Execution failed: ${executionId}`, sdkError);\n      }\n\n      throw sdkError;\n    } finally {\n      this.isExecuting = false;\n    }\n  }\n\n  async executeStreaming(options: ExecutionOptions): Promise<StreamingResult> {\n    const parsed = ExecutionOptionsSchema.parse(options);\n    const executionId = uuidv4();\n    const startTime = Date.now();\n\n    this.isExecuting = true;\n    this.abortController = new AbortController();\n\n    if (parsed.signal) {\n      parsed.signal.addEventListener(\"abort\", () => {\n        this.abortController?.abort();\n      });\n    }\n\n    try {\n      this.emitStarted(executionId);\n\n      const response = await this.executionHandler(parsed.prompt, {\n        agentId: this.id,\n        executionId,\n        tools: this.toolRegistry,\n        abortSignal: this.abortController?.signal ?? new AbortSignal(),\n        onProgress: (event) => this.eventEmitter.emit(event.type, event),\n      });\n\n      if (!(response instanceof Readable)) {\n        throw createSDKError(\n          \"Execution handler must return a Readable stream for streaming execution\",\n          {\n            code: ERROR_CODES.AGENT_EXECUTION_FAILED,\n            agentId: this.id,\n            retryable: false,\n          }\n        );\n      }\n\n      let fullResponse = \"\";\n      const stream = new Readable({\n        async read() {\n          for await (const chunk of response) {\n            fullResponse += chunk;\n            this.push(chunk);\n          }\n          this.push(null);\n        },\n      });\n\n      const duration = Date.now() - startTime;\n      const metrics: Metrics = {\n        agentId: this.id,\n        duration,\n        tokens: {\n          input: this.estimateTokenCount(parsed.prompt),\n          output: this.estimateTokenCount(fullResponse),\n          total:\n            this.estimateTokenCount(parsed.prompt) +\n            this.estimateTokenCount(fullResponse),\n        },\n        toolCalls: 0,\n        retries: 0,\n        errors: 0,\n        status: \"success\",\n        timestamp: new Date(),\n      };\n\n      this.metricsCollector.record(metrics);\n\n      return {\n        agentId: this.id,\n        executionId,\n        response: fullResponse,\n        metrics,\n        stream,\n        streamed: true,\n      };\n    } catch (error) {\n      const duration = Date.now() - startTime;\n      const sdkError =\n        error instanceof SDKError\n          ? error\n          : createSDKError(String(error), {\n              code: ERROR_CODES.AGENT_EXECUTION_FAILED,\n              agentId: this.id,\n              retryable: true,\n            });\n\n      const metrics: Metrics = {\n        agentId: this.id,\n        duration,\n        tokens: {\n          input: this.estimateTokenCount(parsed.prompt),\n          output: 0,\n          total: this.estimateTokenCount(parsed.prompt),\n        },\n        toolCalls: 0,\n        retries: 0,\n        errors: 1,\n        status: \"error\",\n        timestamp: new Date(),\n      };\n\n      this.metricsCollector.record(metrics);\n\n      this.emitError(executionId, sdkError);\n      throw sdkError;\n    }\n  }\n\n  async cancel(): Promise<void> {\n    if (!this.isExecuting) {\n      return;\n    }\n\n    const startTime = Date.now();\n\n    this.abortController?.abort();\n\n    let attempts = 0;\n    while (this.isExecuting && attempts < 20) {\n      await new Promise((resolve) => setTimeout(resolve, 100));\n      attempts++;\n    }\n\n    const duration = Date.now() - startTime;\n\n    if (duration > 2000) {\n      throw new CancellationError(\"Cancellation took longer than 2 seconds\", {\n        agentId: this.id,\n      });\n    }\n\n    if (this.debug) {\n      console.log(\n        `[Agent] Cancelled execution for agent ${this.name} in ${duration}ms`\n      );\n    }\n  }\n\n  setState(state: Record<string, unknown>): void {\n    this.state = { ...state };\n  }\n\n  getState(): Record<string, unknown> {\n    return { ...this.state };\n  }\n\n  getMetrics(): Metrics[] {\n    return this.metricsCollector.getByAgentId(this.id);\n  }\n\n  getLatestMetrics(): Metrics | undefined {\n    return this.metricsCollector.getLatestByAgentId(this.id);\n  }\n\n  getAggregateMetrics() {\n    return this.metricsCollector.getAggregateByAgentId(this.id);\n  }\n\n  onProgress(callback: (event: AgentEvent) => void): this {\n    this.eventEmitter.on(\"progress\", callback);\n    return this;\n  }\n\n  onCompleted(callback: (event: LifecycleEvent) => void): this {\n    this.eventEmitter.on(\"completed\", callback as GenericListener);\n    return this;\n  }\n\n  onError(callback: (event: LifecycleEvent) => void): this {\n    this.eventEmitter.on(\"error\", callback as GenericListener);\n    return this;\n  }\n\n  onCancelled(callback: (event: LifecycleEvent) => void): this {\n    this.eventEmitter.on(\"cancelled\", callback as GenericListener);\n    return this;\n  }\n\n  onToolStarted(\n    callback: (event: import(\"./events.js\").ToolEvent) => void\n  ): this {\n    this.eventEmitter.on(\"toolStarted\", callback as GenericListener);\n    return this;\n  }\n\n  onToolCompleted(\n    callback: (event: import(\"./events.js\").ToolEvent) => void\n  ): this {\n    this.eventEmitter.on(\"toolCompleted\", callback as GenericListener);\n    return this;\n  }\n\n  onToolError(\n    callback: (event: import(\"./events.js\").ToolEvent) => void\n  ): this {\n    this.eventEmitter.on(\"toolError\", callback as GenericListener);\n    return this;\n  }\n\n  private async defaultExecutionHandler(\n    prompt: string,\n    context: {\n      agentId: string;\n      executionId: string;\n      tools: ToolRegistry;\n      abortSignal: AbortSignal;\n      onProgress: (data: AgentEvent) => void;\n    }\n  ): Promise<string> {\n    try {\n      // Emit progress event before making the API call\n      context.onProgress({\n        type: \"progress\",\n        stage: \"calling_llm\",\n        percentage: 0,\n        message: \"Calling GPT-4o-mini...\",\n      });\n\n      // Make the actual LLM API call using Vercel AI SDK\n      const result = await generateText({\n        model: models.chat,\n        system: this.instructions,\n        prompt,\n        temperature: 0.7,\n      });\n\n      // Emit progress event after successful API response\n      context.onProgress({\n        type: \"progress\",\n        stage: \"llm_response\",\n        percentage: 100,\n        message: \"Received response from GPT-4o-mini\",\n      });\n\n      return result.text;\n    } catch (error) {\n      if (this.debug) {\n        console.error(\"[Agent] LLM API call failed:\", error);\n      }\n\n      // Re-throw as SDKError for proper retry handling\n      throw createSDKError(\n        `LLM API call failed: ${error instanceof Error ? error.message : String(error)}`,\n        {\n          code: ERROR_CODES.AGENT_EXECUTION_FAILED,\n          agentId: this.id,\n          retryable: true,\n          context: { originalError: error },\n        }\n      );\n    }\n  }\n\n  private emitStarted(executionId: string): void {\n    const event: LifecycleEvent = {\n      type: \"started\",\n      agentId: this.id,\n      timestamp: new Date(),\n      data: { executionId },\n    };\n    this.eventEmitter.emit(\"started\", event);\n  }\n\n  private emitCompleted(executionId: string, response: string): void {\n    const event: LifecycleEvent = {\n      type: \"completed\",\n      agentId: this.id,\n      timestamp: new Date(),\n      data: { executionId, response },\n    };\n    this.eventEmitter.emit(\"completed\", event);\n  }\n\n  private emitError(executionId: string, error: SDKError): void {\n    const event: LifecycleEvent = {\n      type: \"error\",\n      agentId: this.id,\n      timestamp: new Date(),\n      data: { executionId },\n      error,\n    };\n    this.eventEmitter.emit(\"error\", event);\n  }\n\n  private estimateTokenCount(text: string): number {\n    return Math.ceil(text.length / 4);\n  }\n}\n\nexport function createAgent(\n  config: AgentConfig,\n  options?: {\n    executionHandler?: ExecutionHandler;\n    metricsCollector?: MetricsCollector;\n  }\n): Agent {\n  return new Agent(config, options);\n}\n","export const ERROR_CODES = {\n  AUTH_INVALID: \"AUTH_INVALID\",\n  AUTH_EXPIRED: \"AUTH_EXPIRED\",\n  RATE_LIMIT_EXCEEDED: \"RATE_LIMIT_EXCEEDED\",\n  TIMEOUT: \"TIMEOUT\",\n  TOOL_EXECUTION_FAILED: \"TOOL_EXECUTION_FAILED\",\n  TOOL_NOT_FOUND: \"TOOL_NOT_FOUND\",\n  TOOL_VALIDATION_FAILED: \"TOOL_VALIDATION_FAILED\",\n  AGENT_NOT_FOUND: \"AGENT_NOT_FOUND\",\n  AGENT_EXECUTION_FAILED: \"AGENT_EXECUTION_FAILED\",\n  WORKFLOW_ERROR: \"WORKFLOW_ERROR\",\n  STATE_ERROR: \"STATE_ERROR\",\n  CANCELLATION_FAILED: \"CANCELLATION_FAILED\",\n  METRICS_ERROR: \"METRICS_ERROR\",\n  CONFIG_INVALID: \"CONFIG_INVALID\",\n  INTERNAL_ERROR: \"INTERNAL_ERROR\",\n} as const;\n\nexport type ErrorCode = (typeof ERROR_CODES)[keyof typeof ERROR_CODES];\n\nexport interface SDKErrorOptions extends ErrorOptions {\n  code: ErrorCode;\n  agentId?: string;\n  toolName?: string;\n  retryable?: boolean;\n  troubleshootingUrl?: string;\n  context?: Record<string, unknown>;\n}\n\nexport class SDKError extends Error {\n  public readonly code: ErrorCode;\n  public readonly agentId?: string;\n  public readonly toolName?: string;\n  public readonly retryable: boolean;\n  public readonly troubleshootingUrl?: string;\n  public readonly context?: Record<string, unknown>;\n  public readonly timestamp: Date;\n\n  constructor(message: string, options: SDKErrorOptions) {\n    super(message, options);\n    this.name = this.constructor.name;\n    this.code = options.code;\n    this.agentId = options.agentId;\n    this.toolName = options.toolName;\n    this.retryable = options.retryable ?? false;\n    this.troubleshootingUrl = options.troubleshootingUrl;\n    this.context = options.context;\n    this.timestamp = new Date();\n\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, this.constructor);\n    }\n  }\n\n  toJSON(): Record<string, unknown> {\n    return {\n      name: this.name,\n      message: this.message,\n      code: this.code,\n      agentId: this.agentId,\n      toolName: this.toolName,\n      retryable: this.retryable,\n      troubleshootingUrl: this.troubleshootingUrl,\n      context: this.context,\n      timestamp: this.timestamp.toISOString(),\n      stack: this.stack,\n    };\n  }\n}\n\nexport class AuthenticationError extends SDKError {\n  constructor(message: string, options?: Omit<SDKErrorOptions, \"code\">) {\n    super(message, {\n      ...options,\n      code: ERROR_CODES.AUTH_INVALID,\n      retryable: true,\n      troubleshootingUrl: \"https://docs.example.com/auth\",\n    });\n    this.name = \"AuthenticationError\";\n  }\n}\n\nexport class AuthenticationExpiredError extends SDKError {\n  constructor(message: string, options?: Omit<SDKErrorOptions, \"code\">) {\n    super(message, {\n      ...options,\n      code: ERROR_CODES.AUTH_EXPIRED,\n      retryable: true,\n      troubleshootingUrl: \"https://docs.example.com/auth#expired\",\n    });\n    this.name = \"AuthenticationExpiredError\";\n  }\n}\n\nexport class RateLimitExceededError extends SDKError {\n  constructor(message: string, options?: Omit<SDKErrorOptions, \"code\">) {\n    super(message, {\n      ...options,\n      code: ERROR_CODES.RATE_LIMIT_EXCEEDED,\n      retryable: true,\n      troubleshootingUrl: \"https://docs.example.com/rate-limit\",\n    });\n    this.name = \"RateLimitExceededError\";\n  }\n}\n\nexport class TimeoutError extends SDKError {\n  constructor(message: string, options?: Omit<SDKErrorOptions, \"code\">) {\n    super(message, {\n      ...options,\n      code: ERROR_CODES.TIMEOUT,\n      retryable: true,\n      troubleshootingUrl: \"https://docs.example.com/timeout\",\n    });\n    this.name = \"TimeoutError\";\n  }\n}\n\nexport class ToolExecutionError extends SDKError {\n  constructor(message: string, options?: Omit<SDKErrorOptions, \"code\">) {\n    super(message, {\n      ...options,\n      code: ERROR_CODES.TOOL_EXECUTION_FAILED,\n      retryable: options?.retryable ?? true,\n      troubleshootingUrl: \"https://docs.example.com/tools#execution\",\n    });\n    this.name = \"ToolExecutionError\";\n  }\n}\n\nexport class ToolNotFoundError extends SDKError {\n  constructor(\n    toolName: string,\n    options?: Omit<SDKErrorOptions, \"code\" | \"toolName\">\n  ) {\n    super(`Tool not found: ${toolName}`, {\n      ...options,\n      code: ERROR_CODES.TOOL_NOT_FOUND,\n      toolName,\n      retryable: false,\n      troubleshootingUrl: \"https://docs.example.com/tools#not-found\",\n    });\n    this.name = \"ToolNotFoundError\";\n  }\n}\n\nexport class ToolValidationError extends SDKError {\n  constructor(message: string, options?: Omit<SDKErrorOptions, \"code\">) {\n    super(message, {\n      ...options,\n      code: ERROR_CODES.TOOL_VALIDATION_FAILED,\n      retryable: false,\n      troubleshootingUrl: \"https://docs.example.com/tools#validation\",\n    });\n    this.name = \"ToolValidationError\";\n  }\n}\n\nexport class AgentNotFoundError extends SDKError {\n  constructor(\n    agentId: string,\n    options?: Omit<SDKErrorOptions, \"code\" | \"agentId\">\n  ) {\n    super(`Agent not found: ${agentId}`, {\n      ...options,\n      code: ERROR_CODES.AGENT_NOT_FOUND,\n      agentId,\n      retryable: false,\n      troubleshootingUrl: \"https://docs.example.com/agents#not-found\",\n    });\n    this.name = \"AgentNotFoundError\";\n  }\n}\n\nexport class AgentExecutionError extends SDKError {\n  constructor(message: string, options?: Omit<SDKErrorOptions, \"code\">) {\n    super(message, {\n      ...options,\n      code: ERROR_CODES.AGENT_EXECUTION_FAILED,\n      retryable: options?.retryable ?? true,\n      troubleshootingUrl: \"https://docs.example.com/agents#execution\",\n    });\n    this.name = \"AgentExecutionError\";\n  }\n}\n\nexport class WorkflowError extends SDKError {\n  constructor(message: string, options?: Omit<SDKErrorOptions, \"code\">) {\n    super(message, {\n      ...options,\n      code: ERROR_CODES.WORKFLOW_ERROR,\n      retryable: options?.retryable ?? false,\n      troubleshootingUrl: \"https://docs.example.com/workflows#errors\",\n    });\n    this.name = \"WorkflowError\";\n  }\n}\n\nexport class StateError extends SDKError {\n  constructor(message: string, options?: Omit<SDKErrorOptions, \"code\">) {\n    super(message, {\n      ...options,\n      code: ERROR_CODES.STATE_ERROR,\n      retryable: false,\n      troubleshootingUrl: \"https://docs.example.com/state#errors\",\n    });\n    this.name = \"StateError\";\n  }\n}\n\nexport class CancellationError extends SDKError {\n  constructor(message: string, options?: Omit<SDKErrorOptions, \"code\">) {\n    super(message, {\n      ...options,\n      code: ERROR_CODES.CANCELLATION_FAILED,\n      retryable: false,\n      troubleshootingUrl: \"https://docs.example.com/cancellation\",\n    });\n    this.name = \"CancellationError\";\n  }\n}\n\nexport class ConfigurationError extends SDKError {\n  constructor(message: string, options?: Omit<SDKErrorOptions, \"code\">) {\n    super(message, {\n      ...options,\n      code: ERROR_CODES.CONFIG_INVALID,\n      retryable: false,\n      troubleshootingUrl: \"https://docs.example.com/configuration\",\n    });\n    this.name = \"ConfigurationError\";\n  }\n}\n\ntype SDKErrorFactory = (message: string, options: SDKErrorOptions) => SDKError;\n\nconst SDK_ERROR_FACTORIES: Partial<Record<ErrorCode, SDKErrorFactory>> = {\n  [ERROR_CODES.AUTH_INVALID]: (message, options) =>\n    new AuthenticationError(message, options),\n  [ERROR_CODES.AUTH_EXPIRED]: (message, options) =>\n    new AuthenticationExpiredError(message, options),\n  [ERROR_CODES.RATE_LIMIT_EXCEEDED]: (message, options) =>\n    new RateLimitExceededError(message, options),\n  [ERROR_CODES.TIMEOUT]: (message, options) =>\n    new TimeoutError(message, options),\n  [ERROR_CODES.TOOL_EXECUTION_FAILED]: (message, options) =>\n    new ToolExecutionError(message, options),\n  [ERROR_CODES.TOOL_VALIDATION_FAILED]: (message, options) =>\n    new ToolValidationError(message, options),\n  [ERROR_CODES.AGENT_EXECUTION_FAILED]: (message, options) =>\n    new AgentExecutionError(message, options),\n  [ERROR_CODES.WORKFLOW_ERROR]: (message, options) =>\n    new WorkflowError(message, options),\n  [ERROR_CODES.STATE_ERROR]: (message, options) =>\n    new StateError(message, options),\n  [ERROR_CODES.CANCELLATION_FAILED]: (message, options) =>\n    new CancellationError(message, options),\n  [ERROR_CODES.INTERNAL_ERROR]: (message, options) =>\n    new SDKError(message, options),\n  [ERROR_CODES.TOOL_NOT_FOUND]: (message, options) =>\n    new SDKError(message, options),\n  [ERROR_CODES.AGENT_NOT_FOUND]: (message, options) =>\n    new SDKError(message, options),\n  [ERROR_CODES.CONFIG_INVALID]: (message, options) =>\n    new SDKError(message, options),\n};\n\nexport function createSDKError(\n  message: string,\n  options: SDKErrorOptions\n): SDKError {\n  const factory = SDK_ERROR_FACTORIES[options.code];\n  return factory ? factory(message, options) : new SDKError(message, options);\n}\n","import { EventEmitter as NodeEventEmitter } from \"node:events\";\nimport type { SDKError } from \"./errors.js\";\n\nexport type EventType =\n  | \"started\"\n  | \"progress\"\n  | \"completed\"\n  | \"error\"\n  | \"cancelled\"\n  | \"toolStarted\"\n  | \"toolProgress\"\n  | \"toolCompleted\"\n  | \"toolError\";\n\nexport type ProgressEvent = {\n  type: \"progress\";\n  stage: string;\n  percentage: number;\n  message: string;\n  estimatedTimeRemaining?: number;\n};\n\nexport type ToolEvent = {\n  type: \"toolStarted\" | \"toolProgress\" | \"toolCompleted\" | \"toolError\";\n  toolName: string;\n  toolCallId: string;\n  data?: unknown;\n  error?: SDKError;\n};\n\nexport type LifecycleEvent = {\n  type: \"started\" | \"completed\" | \"error\" | \"cancelled\";\n  agentId: string;\n  timestamp: Date;\n  data?: unknown;\n  error?: SDKError;\n};\n\nexport type AgentEvent = ProgressEvent | ToolEvent | LifecycleEvent;\n\nexport type GenericListener = (event: AgentEvent) => void;\n\nexport class AgentEventEmitter {\n  private readonly emitter: NodeEventEmitter;\n\n  constructor() {\n    this.emitter = new NodeEventEmitter();\n    this.emitter.setMaxListeners(100);\n  }\n\n  on(event: EventType, listener: GenericListener): this {\n    this.emitter.on(event, listener);\n    return this;\n  }\n\n  once(event: EventType, listener: GenericListener): this {\n    this.emitter.once(event, listener);\n    return this;\n  }\n\n  off(event: EventType, listener: GenericListener): this {\n    this.emitter.off(event, listener);\n    return this;\n  }\n\n  emit(event: EventType, eventObject: AgentEvent): boolean {\n    return this.emitter.emit(event, eventObject);\n  }\n\n  onStarted(listener: (event: LifecycleEvent) => void): this {\n    this.emitter.on(\"started\", listener as GenericListener);\n    return this;\n  }\n\n  onProgress(listener: (event: ProgressEvent) => void): this {\n    this.emitter.on(\"progress\", listener as GenericListener);\n    return this;\n  }\n\n  onCompleted(listener: (event: LifecycleEvent) => void): this {\n    this.emitter.on(\"completed\", listener as GenericListener);\n    return this;\n  }\n\n  onError(listener: (event: LifecycleEvent) => void): this {\n    this.emitter.on(\"error\", listener as GenericListener);\n    return this;\n  }\n\n  onCancelled(listener: (event: LifecycleEvent) => void): this {\n    this.emitter.on(\"cancelled\", listener as GenericListener);\n    return this;\n  }\n\n  onToolStarted(listener: (event: ToolEvent) => void): this {\n    this.emitter.on(\"toolStarted\", listener as GenericListener);\n    return this;\n  }\n\n  onToolProgress(listener: (event: ToolEvent) => void): this {\n    this.emitter.on(\"toolProgress\", listener as GenericListener);\n    return this;\n  }\n\n  onToolCompleted(listener: (event: ToolEvent) => void): this {\n    this.emitter.on(\"toolCompleted\", listener as GenericListener);\n    return this;\n  }\n\n  onToolError(listener: (event: ToolEvent) => void): this {\n    this.emitter.on(\"toolError\", listener as GenericListener);\n    return this;\n  }\n\n  removeAllListeners(): this {\n    this.emitter.removeAllListeners();\n    return this;\n  }\n}\n","import { z } from \"zod\";\nimport type { Metrics } from \"./types.js\";\n\nexport const MetricsExportSchema = z.object({\n  format: z.enum([\"json\", \"prometheus\", \"datadog\", \"webhook\"]),\n  destination: z.string(),\n});\n\nexport type MetricsExportConfig = z.infer<typeof MetricsExportSchema>;\n\nexport type MetricsCollectorOptions = {\n  maxEntries?: number;\n  exportConfig?: MetricsExportConfig;\n};\n\nexport class MetricsCollector {\n  private readonly entries: Metrics[] = [];\n  private readonly maxEntries: number;\n  private readonly exportConfig?: MetricsExportConfig;\n  private exportInterval?: ReturnType<typeof setInterval>;\n  private readonly exportStrategies: Record<\n    MetricsExportConfig[\"format\"],\n    () => Promise<string> | string\n  > = {\n    json: () => JSON.stringify(this.entries, null, 2),\n    prometheus: () => this.exportToPrometheus(),\n    datadog: () => this.exportToDatadog(),\n    webhook: () => this.exportToWebhook(),\n  };\n\n  constructor(options: MetricsCollectorOptions = {}) {\n    this.maxEntries = options.maxEntries ?? 1000;\n    this.exportConfig = options.exportConfig;\n\n    if (this.exportConfig) {\n      this.startExportInterval();\n    }\n  }\n\n  record(metrics: Metrics): void {\n    this.entries.push(metrics);\n\n    if (this.entries.length > this.maxEntries) {\n      this.entries.shift();\n    }\n  }\n\n  getByAgentId(agentId: string): Metrics[] {\n    return this.entries.filter((m) => m.agentId === agentId);\n  }\n\n  getLatestByAgentId(agentId: string): Metrics | undefined {\n    const agentMetrics = this.getByAgentId(agentId);\n    return agentMetrics.at(-1);\n  }\n\n  getAggregateByAgentId(agentId: string): AggregateMetrics {\n    const agentMetrics = this.getByAgentId(agentId);\n\n    if (agentMetrics.length === 0) {\n      return {\n        totalExecutions: 0,\n        successRate: 0,\n        averageDuration: 0,\n        totalTokens: 0,\n        totalToolCalls: 0,\n        totalRetries: 0,\n        totalErrors: 0,\n      };\n    }\n\n    const successfulExecutions = agentMetrics.filter(\n      (m) => m.status === \"success\"\n    );\n    const totalDuration = agentMetrics.reduce((sum, m) => sum + m.duration, 0);\n    const totalTokens = agentMetrics.reduce(\n      (sum, m) => sum + m.tokens.total,\n      0\n    );\n    const totalToolCalls = agentMetrics.reduce(\n      (sum, m) => sum + m.toolCalls,\n      0\n    );\n    const totalRetries = agentMetrics.reduce((sum, m) => sum + m.retries, 0);\n    const totalErrors = agentMetrics.reduce((sum, m) => sum + m.errors, 0);\n\n    return {\n      totalExecutions: agentMetrics.length,\n      successRate: successfulExecutions.length / agentMetrics.length,\n      averageDuration: totalDuration / agentMetrics.length,\n      totalTokens,\n      totalToolCalls,\n      totalRetries,\n      totalErrors,\n    };\n  }\n\n  getAll(): Metrics[] {\n    return [...this.entries];\n  }\n\n  clear(): void {\n    this.entries.length = 0;\n  }\n\n  async export(): Promise<string> {\n    if (!this.exportConfig) {\n      throw new Error(\"Export not configured\");\n    }\n\n    const strategy = this.exportStrategies[this.exportConfig.format];\n\n    if (!strategy) {\n      throw new Error(`Unsupported export format: ${this.exportConfig.format}`);\n    }\n\n    return await strategy();\n  }\n\n  private startExportInterval(): void {\n    if (this.exportInterval) {\n      clearInterval(this.exportInterval);\n    }\n\n    this.exportInterval = setInterval(async () => {\n      try {\n        await this.exportToWebhook();\n      } catch (error) {\n        console.error(\"Failed to export metrics:\", error);\n      }\n    }, 60_000);\n  }\n\n  private async exportToWebhook(): Promise<string> {\n    if (!this.exportConfig) {\n      throw new Error(\"Export not configured\");\n    }\n\n    const response = await fetch(this.exportConfig.destination, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(this.entries),\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to export metrics: ${response.statusText}`);\n    }\n\n    return \"Metrics exported successfully\";\n  }\n\n  private exportToPrometheus(): string {\n    const lines: string[] = [];\n\n    for (const metric of this.entries) {\n      lines.push(`# Agent: ${metric.agentId}`);\n      lines.push(`agent_execution_duration_seconds ${metric.duration / 1000}`);\n      lines.push(`agent_tokens_input ${metric.tokens.input}`);\n      lines.push(`agent_tokens_output ${metric.tokens.output}`);\n      lines.push(`agent_tokens_total ${metric.tokens.total}`);\n      lines.push(`agent_tool_calls_total ${metric.toolCalls}`);\n      lines.push(`agent_retries_total ${metric.retries}`);\n      lines.push(`agent_errors_total ${metric.errors}`);\n      lines.push(\n        `agent_execution_status ${metric.status === \"success\" ? 1 : 0}`\n      );\n    }\n\n    return lines.join(\"\\n\");\n  }\n\n  private exportToDatadog(): Promise<string> {\n    const _series = this.entries.map((metric) => ({\n      metric: \"agent.execution\",\n      points: [\n        [Math.floor(metric.timestamp.getTime() / 1000), metric.duration],\n      ],\n      tags: [\n        `agent:${metric.agentId}`,\n        `status:${metric.status}`,\n        `errors:${metric.errors}`,\n      ],\n    }));\n\n    return this.exportToWebhook();\n  }\n\n  destroy(): void {\n    if (this.exportInterval) {\n      clearInterval(this.exportInterval);\n    }\n  }\n}\n\nexport type AggregateMetrics = {\n  totalExecutions: number;\n  successRate: number;\n  averageDuration: number;\n  totalTokens: number;\n  totalToolCalls: number;\n  totalRetries: number;\n  totalErrors: number;\n};\n","import { createOpenAI } from \"@ai-sdk/openai\";\nimport type { LanguageModel } from \"ai\";\nimport { keys } from \"./keys.js\";\n\nconst openai = createOpenAI({\n  apiKey: keys().OPENAI_API_KEY,\n});\n\nexport const models: {\n  chat: LanguageModel;\n  embeddings: LanguageModel;\n} = {\n  chat: openai(\"gpt-4o-mini\"),\n  embeddings: openai(\"text-embedding-3-small\"),\n};\n","import { createEnv } from \"@t3-oss/env-nextjs\";\nimport { z } from \"zod\";\n\nexport const keys = () =>\n  createEnv({\n    server: {\n      OPENAI_API_KEY: z.string().startsWith(\"sk-\").optional(),\n    },\n    runtimeEnv: {\n      OPENAI_API_KEY: process.env.OPENAI_API_KEY,\n    },\n  });\n","import {\n  createSDKError,\n  ERROR_CODES,\n  type ErrorCode,\n  SDKError,\n} from \"./errors.js\";\n\nexport type RetryOptions = {\n  maxAttempts?: number;\n  initialDelay?: number;\n  maxDelay?: number;\n  backoffMultiplier?: number;\n  retryableErrors?: ErrorCode[];\n  onRetry?: (attempt: number, error: SDKError) => void;\n};\n\nexport class RetryManager {\n  private readonly maxAttempts: number;\n  private readonly initialDelay: number;\n  private readonly maxDelay: number;\n  private readonly backoffMultiplier: number;\n  private readonly retryableErrors: Set<ErrorCode>;\n  private readonly onRetry?: (attempt: number, error: SDKError) => void;\n\n  constructor(options: RetryOptions = {}) {\n    this.maxAttempts = options.maxAttempts ?? 3;\n    this.initialDelay = options.initialDelay ?? 1000;\n    this.maxDelay = options.maxDelay ?? 30_000;\n    this.backoffMultiplier = options.backoffMultiplier ?? 2;\n    this.retryableErrors = new Set(\n      options.retryableErrors ?? [\n        ERROR_CODES.RATE_LIMIT_EXCEEDED,\n        ERROR_CODES.TIMEOUT,\n        ERROR_CODES.TOOL_EXECUTION_FAILED,\n        ERROR_CODES.AUTH_EXPIRED,\n      ]\n    );\n    this.onRetry = options.onRetry;\n  }\n\n  async execute<T>(\n    operation: () => Promise<T>,\n    abortSignal?: AbortSignal\n  ): Promise<T> {\n    let lastError: SDKError | undefined;\n    let attempt = 0;\n\n    while (attempt < this.maxAttempts) {\n      try {\n        if (abortSignal?.aborted) {\n          throw createSDKError(\"Operation was cancelled\", {\n            code: ERROR_CODES.CANCELLATION_FAILED,\n            retryable: false,\n          });\n        }\n        return await operation();\n      } catch (error) {\n        const sdkError = this.ensureSDKError(error);\n        lastError = sdkError;\n\n        if (!this.isRetryable(sdkError) || attempt >= this.maxAttempts - 1) {\n          throw sdkError;\n        }\n\n        const delay = this.calculateDelay(attempt);\n\n        if (this.onRetry) {\n          this.onRetry(attempt + 1, sdkError);\n        }\n\n        await this.delay(delay, abortSignal);\n        attempt++;\n      }\n    }\n\n    throw lastError;\n  }\n\n  private isRetryable(error: SDKError): boolean {\n    return error.retryable || this.retryableErrors.has(error.code);\n  }\n\n  private calculateDelay(attempt: number): number {\n    const delay = this.initialDelay * this.backoffMultiplier ** attempt;\n    return Math.min(delay, this.maxDelay);\n  }\n\n  private async delay(ms: number, abortSignal?: AbortSignal): Promise<void> {\n    return new Promise((resolve, reject) => {\n      if (abortSignal?.aborted) {\n        reject(\n          createSDKError(\"Operation was cancelled during retry delay\", {\n            code: ERROR_CODES.CANCELLATION_FAILED,\n            retryable: false,\n          })\n        );\n        return;\n      }\n\n      const timeoutId = setTimeout(resolve, ms);\n\n      abortSignal?.addEventListener(\"abort\", () => {\n        clearTimeout(timeoutId);\n        reject(\n          createSDKError(\"Operation was cancelled during retry delay\", {\n            code: ERROR_CODES.CANCELLATION_FAILED,\n            retryable: false,\n          })\n        );\n      });\n    });\n  }\n\n  private ensureSDKError(error: unknown): SDKError {\n    if (error instanceof SDKError) {\n      return error;\n    }\n\n    const message = error instanceof Error ? error.message : \"Unknown error\";\n    const stack = error instanceof Error ? error.stack : undefined;\n\n    const sdkError = createSDKError(message, {\n      code: ERROR_CODES.INTERNAL_ERROR,\n      retryable: false,\n    });\n\n    if (stack) {\n      sdkError.stack = stack;\n    }\n\n    return sdkError;\n  }\n}\n","import { z } from \"zod\";\nimport { createSDKError, ERROR_CODES, SDKError } from \"./errors.js\";\n\nexport type ToolParameterSchema = z.ZodType<unknown>;\n\nexport type ToolParameters = {\n  [key: string]: ToolParameterSchema;\n};\n\nexport type ToolResult<T = unknown> = {\n  success: boolean;\n  data?: T;\n  error?: SDKError;\n};\n\nexport type ToolDefinition = {\n  name: string;\n  description: string;\n  parameters: ToolParameters;\n  returns: ToolParameterSchema;\n  retryable: boolean;\n};\n\nexport type ToolFunction<\n  TParameters extends Record<string, unknown> = Record<string, unknown>,\n  TReturn = unknown,\n> = (\n  params: TParameters,\n  context?: ToolContext\n) => Promise<ToolResult<TReturn>>;\n\nexport type ToolContext = {\n  agentId: string;\n  executionId: string;\n  abortSignal?: AbortSignal;\n  onProgress?: (data: unknown) => void;\n};\n\nexport type ToolOptions = {\n  name: string;\n  description: string;\n  parameters?: ToolParameters;\n  returns?: ToolParameterSchema;\n  retryable?: boolean;\n};\n\nexport class Tool<\n  TParameters extends Record<string, unknown> = Record<string, unknown>,\n  TReturn = unknown,\n> {\n  public readonly name: string;\n  public readonly description: string;\n  public readonly parameters: ToolParameters;\n  public readonly returns: ToolParameterSchema;\n  public readonly retryable: boolean;\n  private readonly func: ToolFunction<TParameters, TReturn>;\n\n  constructor(func: ToolFunction<TParameters, TReturn>, options: ToolOptions) {\n    this.name = options.name;\n    this.description = options.description;\n    this.parameters = options.parameters ?? {};\n    this.returns = options.returns ?? z.unknown();\n    this.retryable = options.retryable ?? true;\n    this.func = func;\n  }\n\n  async execute(\n    params: TParameters,\n    context: ToolContext\n  ): Promise<ToolResult<TReturn>> {\n    try {\n      const validatedParams = await this.validateParameters(params);\n      const result = await this.func(validatedParams, context);\n      return result;\n    } catch (error) {\n      return {\n        success: false,\n        error:\n          error instanceof SDKError\n            ? error\n            : createSDKError(`Tool execution failed: ${String(error)}`, {\n                code: ERROR_CODES.TOOL_EXECUTION_FAILED,\n                toolName: this.name,\n                retryable: this.retryable,\n                context: { params },\n              }),\n      };\n    }\n  }\n\n  private async validateParameters(params: unknown): Promise<TParameters> {\n    const schema = this.createParameterSchema();\n    const result = await schema.safeParseAsync(params);\n\n    if (!result.success) {\n      const errorMessages = result.error.issues\n        .map((e: { message: string }) => e.message)\n        .join(\", \");\n      throw createSDKError(`Invalid parameters: ${errorMessages}`, {\n        code: ERROR_CODES.TOOL_VALIDATION_FAILED,\n        toolName: this.name,\n        retryable: false,\n        context: { errors: result.error.issues, params },\n      });\n    }\n\n    return result.data;\n  }\n\n  private createParameterSchema(): z.ZodType<TParameters> {\n    const shape: Record<string, z.ZodType> = {};\n\n    for (const [key, schema] of Object.entries(this.parameters)) {\n      shape[key] = schema as z.ZodType;\n    }\n\n    return z.object(shape) as z.ZodType<TParameters>;\n  }\n}\n\nexport function createTool<\n  TParameters extends Record<string, unknown>,\n  TReturn,\n>(\n  func: ToolFunction<TParameters, TReturn>,\n  options: ToolOptions\n): Tool<TParameters, TReturn> {\n  return new Tool(func, options);\n}\n\nexport class ToolRegistry {\n  private readonly tools: Map<string, Tool> = new Map();\n\n  register(tool: Tool): void {\n    if (this.tools.has(tool.name)) {\n      throw createSDKError(`Tool already registered: ${tool.name}`, {\n        code: ERROR_CODES.TOOL_NOT_FOUND,\n        toolName: tool.name,\n        retryable: false,\n      });\n    }\n    this.tools.set(tool.name, tool);\n  }\n\n  unregister(name: string): boolean {\n    return this.tools.delete(name);\n  }\n\n  get(name: string): Tool | undefined {\n    return this.tools.get(name);\n  }\n\n  has(name: string): boolean {\n    return this.tools.has(name);\n  }\n\n  getAll(): Tool[] {\n    return Array.from(this.tools.values());\n  }\n\n  clear(): void {\n    this.tools.clear();\n  }\n}\n","import { z } from \"zod\";\n\nexport const AgentConfigSchema = z.object({\n  name: z.string().min(1).max(100),\n  instructions: z.string().min(1).max(10_000),\n  tools: z.array(z.string()).optional(),\n  maxRetries: z.number().min(0).max(10).optional(),\n  timeout: z.number().min(1000).max(300_000).optional(),\n  streaming: z.boolean().optional(),\n  debug: z.boolean().optional(),\n});\n\nexport type AgentConfig = z.infer<typeof AgentConfigSchema>;\n\nexport const ToolConfigSchema = z.object({\n  name: z.string().min(1).max(100),\n  description: z.string().min(1).max(1000),\n  parameters: z.record(z.string(), z.unknown()).optional(),\n  returns: z.record(z.string(), z.unknown()).optional(),\n  retryable: z.boolean().optional(),\n});\n\nexport type ToolConfig = z.infer<typeof ToolConfigSchema>;\n\nexport const ExecutionOptionsSchema = z.object({\n  prompt: z.string().min(1),\n  context: z.record(z.string(), z.unknown()).optional(),\n  stream: z.boolean().optional(),\n  onProgress: z.function().optional(),\n  signal: z.instanceof(AbortSignal).optional(),\n});\n\nexport type ExecutionOptions = z.infer<typeof ExecutionOptionsSchema>;\n\nexport const RetryConfigSchema = z.object({\n  maxAttempts: z.number().min(1).max(10).optional(),\n  initialDelay: z.number().min(100).max(10_000).optional(),\n  maxDelay: z.number().min(1000).max(60_000).optional(),\n  backoffMultiplier: z.number().min(1.1).max(5).optional(),\n  retryableErrors: z.array(z.string()).optional(),\n});\n\nexport type RetryConfig = z.infer<typeof RetryConfigSchema>;\n\nexport const MetricsSchema = z.object({\n  agentId: z.string(),\n  duration: z.number(),\n  tokens: z.object({\n    input: z.number(),\n    output: z.number(),\n    total: z.number(),\n  }),\n  toolCalls: z.number(),\n  retries: z.number(),\n  errors: z.number(),\n  status: z.enum([\"success\", \"error\", \"cancelled\"]),\n  timestamp: z.date(),\n});\n\nexport type Metrics = z.infer<typeof MetricsSchema>;\n\nexport const SDKConfigSchema = z.object({\n  apiKey: z.string().optional(),\n  baseUrl: z.string().url().optional(),\n  defaultTimeout: z.number().min(1000).max(300_000).optional(),\n  defaultMaxRetries: z.number().min(0).max(10).optional(),\n  debug: z.boolean().optional(),\n  environmentVariables: z.boolean().optional(),\n});\n\nexport type SDKConfig = z.infer<typeof SDKConfigSchema>;\n","import { v4 as uuidv4 } from \"uuid\";\nimport type { Agent, ExecutionResult } from \"./agent.js\";\nimport { createSDKError, ERROR_CODES, SDKError } from \"./errors.js\";\nimport {\n  AgentEventEmitter,\n  type GenericListener,\n  type LifecycleEvent,\n} from \"./events.js\";\n\nexport type WorkflowStep = {\n  id: string;\n  agent: Agent;\n  dependsOn: string[];\n  inputMapping?: Record<string, string>;\n  outputMapping?: Record<string, string>;\n  condition?: (context: WorkflowContext) => boolean;\n};\n\nexport type WorkflowConfig = {\n  name: string;\n  steps: WorkflowStep[];\n  parallelExecution?: boolean;\n  timeout?: number;\n};\n\nexport type WorkflowContext = {\n  workflowId: string;\n  stepResults: Map<string, unknown>;\n  sharedState: Record<string, unknown>;\n  startTime: Date;\n};\n\nexport type WorkflowResult = {\n  workflowId: string;\n  success: boolean;\n  stepResults: Map<string, ExecutionResult>;\n  duration: number;\n  error?: SDKError;\n};\n\nexport class AgentWorkflow {\n  public readonly id: string;\n  public readonly name: string;\n  public readonly steps: WorkflowStep[];\n  public readonly parallelExecution: boolean;\n  public readonly timeout: number;\n  private readonly eventEmitter: AgentEventEmitter;\n  private readonly context: WorkflowContext;\n  private readonly stepExecutionOrder: string[] = [];\n\n\n  constructor(config: WorkflowConfig) {\n    this.id = uuidv4();\n    this.name = config.name;\n    this.steps = config.steps;\n    this.parallelExecution = config.parallelExecution ?? false;\n    this.timeout = config.timeout ?? 300_000;\n\n    this.eventEmitter = new AgentEventEmitter();\n    this.context = {\n      workflowId: this.id,\n      stepResults: new Map(),\n      sharedState: {},\n      startTime: new Date(),\n    };\n\n    this.validateAndOrderSteps();\n  }\n\n  private validateAndOrderSteps(): void {\n    const stepIds = new Set(this.steps.map((s) => s.id));\n    const visited = new Set<string>();\n    const tempVisited = new Set<string>();\n\n    const topologicalSort = (stepId: string) => {\n      if (tempVisited.has(stepId)) {\n        throw createSDKError(`Circular dependency detected: ${stepId}`, {\n          code: ERROR_CODES.WORKFLOW_ERROR,\n          retryable: false,\n        });\n      }\n\n      if (visited.has(stepId)) {\n        return;\n      }\n\n      tempVisited.add(stepId);\n\n      const step = this.steps.find((s) => s.id === stepId);\n      if (step) {\n        for (const depId of step.dependsOn) {\n          if (!stepIds.has(depId)) {\n            throw createSDKError(\n              `Invalid dependency: ${depId} for step ${stepId}`,\n              {\n                code: ERROR_CODES.WORKFLOW_ERROR,\n                retryable: false,\n              }\n            );\n          }\n          topologicalSort(depId);\n        }\n      }\n\n      tempVisited.delete(stepId);\n      visited.add(stepId);\n      this.stepExecutionOrder.push(stepId);\n    };\n\n    for (const step of this.steps) {\n      if (!visited.has(step.id)) {\n        topologicalSort(step.id);\n      }\n    }\n  }\n\n  setSharedState(state: Record<string, unknown>): void {\n    this.context.sharedState = { ...state };\n  }\n\n  getSharedState(): Record<string, unknown> {\n    return { ...this.context.sharedState };\n  }\n\n  async execute(context?: Record<string, unknown>): Promise<WorkflowResult> {\n    if (context) {\n      this.context.sharedState = { ...this.context.sharedState, ...context };\n    }\n\n    const startTime = Date.now();\n\n    try {\n      this.emitWorkflowStarted();\n\n      if (this.parallelExecution) {\n        await this.executeParallel();\n      } else {\n        await this.executeSequential();\n      }\n\n      const duration = Date.now() - startTime;\n\n      this.emitWorkflowCompleted(duration);\n\n      return {\n        workflowId: this.id,\n        success: true,\n        stepResults: this.context.stepResults as Map<string, ExecutionResult>,\n        duration,\n      };\n    } catch (error) {\n      const duration = Date.now() - startTime;\n      const sdkError =\n        error instanceof SDKError\n          ? error\n          : createSDKError(String(error), {\n              code: ERROR_CODES.WORKFLOW_ERROR,\n              retryable: true,\n            });\n\n      this.emitWorkflowError(sdkError, duration);\n\n      return {\n        workflowId: this.id,\n        success: false,\n        stepResults: this.context.stepResults as Map<string, ExecutionResult>,\n        duration,\n        error: sdkError,\n      };\n    }\n  }\n\n  private async executeSequential(): Promise<void> {\n    for (const stepId of this.stepExecutionOrder) {\n      const step = this.steps.find((s) => s.id === stepId);\n      if (!step) {\n        continue;\n      }\n\n      if (step.condition && !step.condition(this.context)) {\n        continue;\n      }\n\n      await this.executeStep(step);\n    }\n  }\n\n  private async executeParallel(): Promise<void> {\n    const levels = this.identifyExecutionLevels();\n\n    for (const level of levels) {\n      const promises = level.map(async (stepId) => {\n        const step = this.steps.find((s) => s.id === stepId);\n        if (!step) {\n          return;\n        }\n\n        if (step.condition && !step.condition(this.context)) {\n          return;\n        }\n\n        await this.executeStep(step);\n      });\n\n      await Promise.all(promises);\n    }\n  }\n\n  private identifyExecutionLevels(): string[][] {\n    const levels: string[][] = [];\n    const remainingSteps = new Set(this.steps.map((s) => s.id));\n\n    while (remainingSteps.size > 0) {\n      const currentLevel: string[] = [];\n\n      for (const stepId of remainingSteps) {\n        const step = this.steps.find((s) => s.id === stepId);\n        if (!step) {\n          continue;\n        }\n\n        const allDepsExecuted = step.dependsOn.every(\n          (depId) => !remainingSteps.has(depId)\n        );\n        if (allDepsExecuted) {\n          currentLevel.push(stepId);\n        }\n      }\n\n      if (currentLevel.length === 0) {\n        throw createSDKError(\n          \"Cannot determine execution order - possible circular dependency\",\n          {\n            code: ERROR_CODES.WORKFLOW_ERROR,\n            retryable: false,\n          }\n        );\n      }\n\n      levels.push(currentLevel);\n      currentLevel.forEach((id) => remainingSteps.delete(id));\n    }\n\n    return levels;\n  }\n\n  private async executeStep(step: WorkflowStep): Promise<void> {\n    const stepStartTime = Date.now();\n    this.emitStepStarted(step);\n\n    try {\n      const input = this.prepareStepInput(step);\n\n      const result = await step.agent.execute({\n        prompt: input,\n      });\n\n      this.context.stepResults.set(step.id, result);\n\n      if (step.outputMapping) {\n        for (const [outputKey, contextKey] of Object.entries(\n          step.outputMapping\n        )) {\n          this.context.sharedState[contextKey] = (\n            result as unknown as Record<string, unknown>\n          )[outputKey];\n        }\n      }\n\n      const duration = Date.now() - stepStartTime;\n      this.emitStepCompleted(step, duration);\n    } catch (error) {\n      const duration = Date.now() - stepStartTime;\n      const sdkError =\n        error instanceof SDKError\n          ? error\n          : createSDKError(String(error), {\n              code: ERROR_CODES.AGENT_EXECUTION_FAILED,\n              retryable: false,\n            });\n\n      this.emitStepError(step, sdkError, duration);\n      throw sdkError;\n    }\n  }\n\n  private prepareStepInput(step: WorkflowStep): string {\n    if (!step.inputMapping) {\n      return \"\";\n    }\n\n    const parts: string[] = [];\n    for (const [inputKey, contextKey] of Object.entries(step.inputMapping)) {\n      const value =\n        this.context.sharedState[contextKey] ??\n        this.context.stepResults.get(contextKey);\n      if (value !== undefined) {\n        parts.push(`${inputKey}: ${JSON.stringify(value)}`);\n      }\n    }\n\n    return parts.join(\"\\n\");\n  }\n\n  private emitWorkflowStarted(): void {\n    const event: LifecycleEvent = {\n      type: \"started\",\n      agentId: this.id,\n      timestamp: new Date(),\n      data: { workflowName: this.name, stepCount: this.steps.length },\n    };\n    this.eventEmitter.emit(\"started\", event);\n  }\n\n  private emitWorkflowCompleted(duration: number): void {\n    const event: LifecycleEvent = {\n      type: \"completed\",\n      agentId: this.id,\n      timestamp: new Date(),\n      data: { workflowName: this.name, duration, stepCount: this.steps.length },\n    };\n    this.eventEmitter.emit(\"completed\", event);\n  }\n\n  private emitWorkflowError(error: SDKError, duration: number): void {\n    const event: LifecycleEvent = {\n      type: \"error\",\n      agentId: this.id,\n      timestamp: new Date(),\n      data: { workflowName: this.name, duration },\n      error,\n    };\n    this.eventEmitter.emit(\"error\", event);\n  }\n\n  private emitStepStarted(step: WorkflowStep): void {\n    const event: LifecycleEvent = {\n      type: \"started\",\n      agentId: step.agent.id,\n      timestamp: new Date(),\n      data: { stepId: step.id, stepName: step.agent.name },\n    };\n    this.eventEmitter.emit(\"started\", event);\n  }\n\n  private emitStepCompleted(step: WorkflowStep, duration: number): void {\n    const event: LifecycleEvent = {\n      type: \"completed\",\n      agentId: step.agent.id,\n      timestamp: new Date(),\n      data: { stepId: step.id, stepName: step.agent.name, duration },\n    };\n    this.eventEmitter.emit(\"completed\", event);\n  }\n\n  private emitStepError(\n    step: WorkflowStep,\n    error: SDKError,\n    duration: number\n  ): void {\n    const event: LifecycleEvent = {\n      type: \"error\",\n      agentId: step.agent.id,\n      timestamp: new Date(),\n      data: { stepId: step.id, stepName: step.agent.name, duration },\n      error,\n    };\n    this.eventEmitter.emit(\"error\", event);\n  }\n\n  onProgress(\n    callback: (event: import(\"./events.js\").AgentEvent) => void\n  ): this {\n    this.eventEmitter.on(\"progress\", callback);\n    return this;\n  }\n\n  onCompleted(callback: (event: LifecycleEvent) => void): this {\n    this.eventEmitter.on(\"completed\", callback as GenericListener);\n    return this;\n  }\n\n  onError(callback: (event: LifecycleEvent) => void): this {\n    this.eventEmitter.on(\"error\", callback as GenericListener);\n    return this;\n  }\n}\n\nexport function createWorkflow(config: WorkflowConfig): AgentWorkflow {\n  return new AgentWorkflow(config);\n}\n"],"mappings":"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","names":["z","z","z","z","z","uuidv4","uuidv4","z"]}