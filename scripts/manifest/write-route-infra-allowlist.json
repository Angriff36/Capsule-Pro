{
  "description": "Infrastructure write routes allowed outside Manifest domain command surface.",
  "rules": [
    {
      "prefix": "/api/webhooks/",
      "methods": ["POST", "PUT", "PATCH", "DELETE"]
    },
    {
      "prefix": "/api/auth/",
      "methods": ["POST", "PUT", "PATCH", "DELETE"]
    },
    {
      "prefix": "/api/cron/",
      "methods": ["POST", "PUT", "PATCH", "DELETE"]
    },
    {
      "prefix": "/api/health",
      "methods": ["POST", "PUT", "PATCH", "DELETE"]
    },
    {
      "prefix": "/api/kitchen/recipes/composite/",
      "methods": ["POST"],
      "comment": "Composite routes wrap multiple Manifest commands in atomic transactions"
    },
    {
      "pattern": "^/api/kitchen/recipes/[^/]+/composite/",
      "methods": ["POST"],
      "comment": "Recipe-scoped composite routes (update-with-version, restore-version)"
    },
    {
      "pattern": "^/api/kitchen/recipes/[^/]+/cost$",
      "methods": ["POST"],
      "comment": "Recipe cost calculation route using RecipeVersion.updateCosts command"
    },
    {
      "pattern": "^/api/kitchen/recipes/[^/]+/scale$",
      "methods": ["POST", "PATCH"],
      "comment": "Recipe scaling routes using RecipeIngredient.updateWasteFactor command"
    },
    {
      "prefix": "/api/kitchen/allergens/update-dish",
      "methods": ["POST"],
      "comment": "Allergen update route using Dish.update command"
    },
    {
      "prefix": "/api/kitchen/allergens/detect-conflicts",
      "methods": ["POST"],
      "comment": "Allergen conflict detection using AllergenWarning.create command"
    },
    {
      "prefix": "/api/kitchen/prep-lists/save-db",
      "methods": ["POST"],
      "comment": "Prep list save route using PrepList/PrepListItem manifest commands"
    },
    {
      "prefix": "/api/kitchen/ai/bulk-generate/prep-tasks",
      "methods": ["POST"],
      "comment": "AI-generated prep task bulk creation using PrepTask.create command"
    },
    {
      "prefix": "/api/kitchen/manifest/",
      "methods": ["POST", "PUT", "PATCH", "DELETE"],
      "comment": "Legacy infrastructure routes using Manifest runtime (to be migrated)"
    },
    {
      "prefix": "/api/conflicts/",
      "methods": ["POST", "PUT", "PATCH", "DELETE"],
      "comment": "Conflict detection infrastructure"
    },
    {
      "prefix": "/api/user-preferences",
      "methods": ["POST"],
      "comment": "User preferences — settings, not domain command (permanently exempted in audit registry)"
    },
    {
      "prefix": "/api/staff/shifts/commands/create-validated",
      "methods": ["POST"],
      "comment": "Validated shift creation with overlap/overtime/certification checks using ScheduleShift.create command"
    },
    {
      "prefix": "/api/staff/shifts/commands/update-validated",
      "methods": ["POST"],
      "comment": "Validated shift update with overlap/overtime/certification checks using ScheduleShift.update command"
    },
    {
      "prefix": "/api/events/allergens/warnings/acknowledge",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — AllergenWarning.acknowledge"
    },
    {
      "pattern": "^/api/events/contracts/[^/]+$",
      "methods": ["PUT", "DELETE"],
      "comment": "Uses executeManifestCommand — EventContract.update/softDelete"
    },
    {
      "pattern": "^/api/events/contracts/[^/]+/signatures$",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — ContractSignature.create"
    },
    {
      "pattern": "^/api/events/[^/]+/guests$",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — EventGuest.create"
    },
    {
      "pattern": "^/api/events/guests/[^/]+$",
      "methods": ["PUT", "DELETE"],
      "comment": "Uses executeManifestCommand — EventGuest.update/softDelete"
    },
    {
      "pattern": "^/api/kitchen/waste/entries/[^/]+$",
      "methods": ["PUT", "DELETE"],
      "comment": "Uses executeManifestCommand — WasteEntry.update/softDelete"
    },
    {
      "pattern": "^/api/inventory/purchase-orders/[^/]+/items/[^/]+/quality$",
      "methods": ["PUT"],
      "comment": "Uses executeManifestCommand — PurchaseOrderItem.update"
    },
    {
      "prefix": "/api/inventory/alerts/subscribe",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — AlertsConfig.create"
    },
    {
      "pattern": "^/api/shipments/[^/]+$",
      "methods": ["PUT", "DELETE"],
      "comment": "Uses executeManifestCommand — Shipment.update/cancel"
    },
    {
      "pattern": "^/api/staff/employees/[^/]+$",
      "methods": ["PUT", "PATCH"],
      "comment": "Uses executeManifestCommand — User.update"
    },
    {
      "prefix": "/api/command-board",
      "methods": ["POST", "PUT", "DELETE"],
      "comment": "Uses executeManifestCommand — CommandBoard/CommandBoardLayout CRUD"
    },
    {
      "prefix": "/api/events/contracts",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — EventContract.create"
    },
    {
      "pattern": "^/api/events/contracts/[^/]+/status$",
      "methods": ["PATCH"],
      "comment": "Uses createManifestRuntime — EventContract.send/sign/expire/cancel/markViewed"
    },
    {
      "pattern": "^/api/events/contracts/[^/]+/send$",
      "methods": ["POST"],
      "comment": "Uses createManifestRuntime — EventContract.send + email side-effect"
    },
    {
      "pattern": "^/api/events/contracts/[^/]+/signature$",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — ContractSignature.create"
    },
    {
      "prefix": "/api/training/modules",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — TrainingModule.create"
    },
    {
      "pattern": "^/api/training/modules/[^/]+$",
      "methods": ["PUT", "DELETE"],
      "comment": "Uses executeManifestCommand — TrainingModule.update/softDelete"
    },
    {
      "prefix": "/api/training/assignments",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — TrainingAssignment.create"
    },
    {
      "prefix": "/api/staff/certifications",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — EmployeeCertification.create"
    },
    {
      "pattern": "^/api/staff/certifications/[^/]+$",
      "methods": ["PUT", "DELETE"],
      "comment": "Uses executeManifestCommand — EmployeeCertification.update/softDelete"
    },
    {
      "prefix": "/api/staff/availability",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — EmployeeAvailability.create"
    },
    {
      "pattern": "^/api/staff/availability/[^/]+$",
      "methods": ["PATCH", "DELETE"],
      "comment": "Uses executeManifestCommand — EmployeeAvailability.update/softDelete"
    },
    {
      "prefix": "/api/staff/time-off/requests",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — TimeOffRequest.create"
    },
    {
      "pattern": "^/api/staff/time-off/requests/[^/]+$",
      "methods": ["PATCH", "DELETE"],
      "comment": "Uses executeManifestCommand — TimeOffRequest commands/softDelete"
    },
    {
      "prefix": "/api/accounting/accounts",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — ChartOfAccount.create"
    },
    {
      "pattern": "^/api/accounting/accounts/[^/]+$",
      "methods": ["PUT", "DELETE"],
      "comment": "Uses executeManifestCommand — ChartOfAccount.update/deactivate"
    },
    {
      "prefix": "/api/administrative/tasks",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — AdminTask.create"
    },
    {
      "pattern": "^/api/administrative/tasks/[^/]+$",
      "methods": ["PATCH", "DELETE"],
      "comment": "Uses executeManifestCommand — AdminTask commands/softDelete"
    },
    {
      "prefix": "/api/collaboration/notifications/email/workflows",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — EmailWorkflow.create"
    },
    {
      "pattern": "^/api/collaboration/notifications/email/workflows/[^/]+$",
      "methods": ["PUT", "DELETE"],
      "comment": "Uses executeManifestCommand — EmailWorkflow.update/softDelete"
    },
    {
      "prefix": "/api/payroll/periods",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — PayrollPeriod.create"
    },
    {
      "prefix": "/api/payroll/deductions",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — EmployeeDeduction.create"
    },
    {
      "prefix": "/api/payroll/approvals",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — PayrollApprovalHistory.create"
    },
    {
      "pattern": "^/api/payroll/runs/[^/]+$",
      "methods": ["PUT"],
      "comment": "Uses executeManifestCommand — PayrollRun.updateStatus"
    },
    {
      "prefix": "/api/staff/budgets",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — LaborBudget.create"
    },
    {
      "pattern": "^/api/staff/budgets/[^/]+$",
      "methods": ["PUT", "DELETE"],
      "comment": "Uses executeManifestCommand — LaborBudget.update/softDelete"
    },
    {
      "prefix": "/api/staff/budgets/alerts",
      "methods": ["POST"],
      "comment": "Uses executeManifestCommand — BudgetAlert.acknowledge/resolve"
    }
  ]
}
